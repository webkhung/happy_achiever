-# Expect mode, date, schedule
%li
  - case mode
    - when :view
      = image_tag(schedule.task.plan.image_path, class: 'schedule-thumb plan-tiny')
      &nbsp;
      = schedule_display(schedule, :time)
    - when :schedule, :edit
      = image_tag(schedule.task.plan.image_path, class: 'schedule-thumb plan-tiny')
      .pull-right
        = link_to(icon_for(:edit), edit_schedule_path(schedule))
        = link_to(icon_for(:remove), schedule, :confirm => 'Are you sure?', method: :delete)

      - if date <= DateTime.now.to_date
        .pull-left
          - achievements = Achievement.achievements_on_date(date)
          - if (task_achieved?(achievements, schedule.task.id, date, schedule.scheduled_date))
            .label.label-warning Achieved!
          - else
            = link_to 'Achieve!', new_task_achievement_path(schedule.task.id,
              :date => combine_date_time(date, schedule.scheduled_date), duration: schedule.duration),
              class: 'btn btn-mini btn-info'
      .clear-both
        %br
        = schedule_display(schedule, :long)
